<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8" />
  <title>Ping Pong</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Share+Tech+Mono&display=swap">
  <link rel="stylesheet" href="./welcome.css">
  <link rel="stylesheet" href="./music.css">
  <link rel="stylesheet" href="./game.css">
  <link rel="stylesheet" href="./pageloader-script/pageloader.css">
</head>

<body>
  <canvas id="bgCanvas"></canvas>
  <div id="pageLoader"></div>

  <div id="guideDock" class="guide-dock">
    <button id="guideBtn" class="neon-btn guide-toggle">HELP?</button>
  </div>

  <div id="guideModal" class="guide-modal hidden">
    <div class="guide-content">
      <h2>⚙️ GUIDE ⚙️</h2>
      <div id="guideContent"></div>
      <div class="guide-close"></div>
    </div>
  </div>

  <div id="musicDock">
    <svg id="musicWaveBg" viewBox="0 0 340 80" preserveAspectRatio="none"></svg>
    <div id="musicControls">
      <button class="music-btn" id="musicRestart" title="Restart">
        <svg class="music-icon" viewBox="0 0 32 32">
          <polygon points="21,7 9,16 21,25" />
          <rect x="5" y="7" width="3.2" height="18" rx="1.5" />
        </svg>
      </button>
      <button id="musicPlay" title="Play/Pause">
        <svg id="musicMainIcon" class="music-icon" viewBox="0 0 32 32">
          <polygon points="13,10 22,16 13,22" />
        </svg>
      </button>
      <button class="music-btn" id="musicLoop" title="Loop">
        <svg class="music-icon" viewBox="0 0 32 32">
          <polygon points="11,7 23,16 11,25" />
          <rect x="23.8" y="7" width="3.2" height="18" rx="1.5" />
        </svg>
      </button>
      <div id="musicInfo" class="music-info">Track <span id="musicIndex">1</span> / 12</div>
    </div>
  </div>
  <audio id="musicAudio" preload="auto"></audio>

  <div id="screenRoot">
    <div id="welcomeScreen" class="screen-slide-in">
      <div class="container tilt">
        <h1 class="neon-text" id="mainTitle">WELCOME TO PING PONG!</h1>
        <p class="neon-text" id="intoText">Experience a fast, retro neon ping pong duel with reactive computer based paddle, Glowing visuals and built-in vibe music</p>
        <button id="enterGameBtn" class="neon-btn">Enter "V/S COMPUTER" MODE</button>
      </div>
    </div>
  </div>

  <script src="./bg/bg.js"></script>
  <script src="./music.js"></script>
  <script src="./game.js"></script>
  <script src="./app.js"></script>
  <script src="./vanillajs/vanilla-tilt.min.js"></script>
  <script src="./pageloader-script/pageloader.js"></script>
  <script src="./guide/guide.js"></script>


  <script>
    document.addEventListener('DOMContentLoaded', () => {
      if (window.PageLoader && window.PageLoader.show && window.PageLoader.hide) {
        window.PageLoader.show();
        setTimeout(() => {
          window.PageLoader.hide();
        }, 2000);
      } else {
        const loader = document.getElementById('pageLoader');
        if (!loader) return;
        loader.classList.add('active');
        setTimeout(() => loader.classList.remove('active'), 2000);
      }

      initWelcomeEffects();
    });

    function wrapLetters(id) {
      const el = document.getElementById(id);
      if (!el) return;
      const text = el.textContent;
      const parts = text.split(/(\s+)/);

      el.innerHTML = parts
        .map(part => {
          if (/^\s+$/.test(part)) {
            return part;
          }
          return [...part]
            .map(ch => `<span class="neon-letter">${ch}</span>`)
            .join('');
        })
        .join('');
    }


    function initWelcomeEffects() {
      wrapLetters('mainTitle');
      wrapLetters('introText');
      wrapLetters('descText');

      if (window.VanillaTilt) {
        VanillaTilt.init(document.querySelectorAll('.tilt'), {
          max: 10,
          speed: 400,
        });
        VanillaTilt.init(document.querySelectorAll('.neon-btn'));
      }
    }
  </script>
</body>

</html>